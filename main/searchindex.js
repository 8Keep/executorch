Search.setIndex({"docnames": ["compiler-custom-compiler-passes", "compiler-delegate-and-partitioner", "compiler-kernel-fusion-pass", "compiler-memory-planning", "export-overview", "export-user-guide", "getting-started-architecture", "getting-started-setup", "index", "intro-how-it-works", "intro-overview", "ir-exir", "ir-high-order-operators", "ir-ops-set-definition", "kernel-library-custom-aten-kernel", "kernel-library-overview", "markdown-sphinx-tips-tricks", "quantization-custom-quantization", "runtime-api", "runtime-backend-delegate-implementation-and-linking", "runtime-build-and-cross-compilation", "runtime-custom-memory-allocator", "runtime-error-handling", "runtime-overview", "runtime-platform-abstraction-layer", "sdk-bundled-io", "sdk-debugging", "sdk-delegate-integration", "sdk-profiling", "tutorials/index", "tutorials/template_tutorial"], "filenames": ["compiler-custom-compiler-passes.md", "compiler-delegate-and-partitioner.md", "compiler-kernel-fusion-pass.md", "compiler-memory-planning.md", "export-overview.md", "export-user-guide.rst", "getting-started-architecture.md", "getting-started-setup.md", "index.rst", "intro-how-it-works.md", "intro-overview.md", "ir-exir.md", "ir-high-order-operators.md", "ir-ops-set-definition.md", "kernel-library-custom-aten-kernel.md", "kernel-library-overview.md", "markdown-sphinx-tips-tricks.md", "quantization-custom-quantization.md", "runtime-api.md", "runtime-backend-delegate-implementation-and-linking.md", "runtime-build-and-cross-compilation.md", "runtime-custom-memory-allocator.md", "runtime-error-handling.md", "runtime-overview.md", "runtime-platform-abstraction-layer.md", "sdk-bundled-io.md", "sdk-debugging.md", "sdk-delegate-integration.md", "sdk-profiling.md", "tutorials/index.rst", "tutorials/template_tutorial.rst"], "titles": ["Custom Compiler Passes and Partitioners", "Backend and Delegate", "Kernel Fusion Pass", "Memory Planning", "Exporting to ExecuTorch", "Export User Guide", "High-level Architecture and Components of ExecuTorch", "Setting Up ExecuTorch", "Welcome to the ExecuTorch Documentation", "How it works", "ExecuTorch Overview", "EXIR", "High-order Operators", "OpSet definition", "Custom ATen Compliant Kernel Implementation and Linking", "Kernel Library Overview", "Markdown in Sphinx Tips and Tricks", "Custom Quantization", "Runtime API", "Backend Delegate Implementation and Linking", "Build and cross-compilation", "Custom Memory Allocator", "Runtime Error Handling", "Runtime Overview", "Platform Abstraction Layer", "BundledIO", "Debugging", "Delegate Integration", "Profiling", "Tutorials", "Template Tutorial"], "terms": {"can": [0, 1, 8, 16, 30], "roughli": 0, "categor": 0, "coupl": [0, 1], "ax": 0, "axi": 0, "A": [0, 1, 8, 16], "creat": [0, 1, 30], "one": [0, 1, 8, 16, 30], "map": [0, 1, 16], "exampl": [0, 1, 16, 29, 30], "decomposit": 0, "mani": 0, "fusion": 0, "b": [0, 1, 16], "perform": [0, 1, 8], "forward": [0, 1], "iter": 0, "shape": 0, "propag": 0, "backward": [0, 8], "dead": 0, "code": [0, 1, 29, 30], "elimin": 0, "c": [0, 16], "depend": [0, 1], "node": [0, 1], "eg": 0, "out": [0, 1, 8], "variant": 0, "convers": 0, "global": 0, "graph": [0, 1, 8], "memori": 0, "plan": [0, 1], "our": 0, "project": [0, 8], "frequenc": 0, "us": [0, 1, 8, 16, 30], "case": [0, 1], "ar": [0, 1, 8], "For": [0, 1, 8, 16, 30], "look": [0, 1, 16], "we": [0, 1, 8, 16], "helper": [0, 1], "class": [0, 1, 16], "call": [0, 1], "exportpass": 0, "thi": [0, 1, 5, 8, 16, 18, 30], "an": [0, 1, 8, 16, 18], "interpret": 0, "wai": [0, 1], "where": [0, 1], "execut": 0, "each": 0, "recreat": 0, "except": [0, 8], "transform": [0, 1], "specifi": [0, 1], "allow": [0, 16], "preserv": 0, "ir": [0, 1, 8], "spec": [0, 1], "ensur": 0, "all": [0, 1, 8, 29, 30], "while": [0, 1], "meet": 0, "includ": [0, 1, 16], "metadata": 0, "stack": 0, "trace": [0, 1], "faketensor": 0, "valu": [0, 1], "torch": [0, 1, 8, 30], "nn": [0, 1], "modul": 0, "heirarchi": 0, "updat": 0, "made": 0, "To": [0, 1, 8, 30], "implement": [0, 1], "subclass": 0, "expos": 0, "function": [0, 1], "when": [0, 1], "run": [0, 1, 8, 30], "new": 0, "contain": [0, 1], "chang": [0, 1, 8], "mean": [0, 1], "must": 0, "runnabl": 0, "cpu": 0, "invari": 0, "maintain": [0, 8], "after": [0, 1, 16], "want": [0, 1, 8], "replac": 0, "op": 0, "anoth": [0, 1, 16], "given": [0, 1, 8], "fx": [0, 1], "graphmodul": [0, 1], "everi": 0, "time": [0, 8, 30], "see": [0, 1, 8, 16], "return": [0, 1], "consid": 0, "follow": [0, 1, 30], "replaceinplacereluwithoutofplacerelupass": 0, "relu_": 0, "place": 0, "version": 0, "relu": 0, "which": [0, 1], "def": [0, 1, 16], "call_oper": 0, "self": [0, 1, 16], "arg": [0, 1], "kwarg": 0, "meta": [0, 1], "aten": 0, "default": 0, "super": [0, 1], "replace_pass": 0, "new_graph_modul": 0, "graph_modul": 0, "The": [0, 1, 16, 30], "call_funct": 0, "result": [0, 1, 30], "oper": [0, 1, 8], "argument": 0, "If": [0, 1, 8, 30], "do": [0, 1, 30], "like": [0, 1, 8, 16, 30], "other": [0, 1, 16, 30], "would": 0, "make": [0, 1, 30], "replaceaddwithmulsub": 0, "origin": 0, "f": [0, 1], "y": [0, 1], "z": 0, "add": [0, 1, 16, 30], "mul_r": 0, "mul": [0, 1], "sub": 0, "remov": [0, 30], "just": [0, 1], "removedetachpass": 0, "detach": 0, "detach_copi": 0, "assert": 0, "len": 0, "0": [0, 1, 30], "convert": [0, 1], "scalar": 0, "within": [0, 1], "tensor": 0, "It": [0, 1, 5], "might": [0, 8, 18], "someth": [0, 1], "args_map": 0, "fn": 0, "isinst": 0, "tupl": 0, "dict": 0, "list": [0, 1, 16], "copi": [0, 30], "kei": [0, 30], "schema": 0, "i": [0, 16], "enumer": 0, "_schema": 0, "name": [0, 1, 16], "elif": 0, "kwarg_onli": 0, "scalartotensorpass": 0, "try_coerc": 0, "float": 0, "int": 0, "bool": 0, "type": [0, 1], "tensortyp": 0, "els": 0, "s": [0, 1], "rewrit": 0, "pattern": 0, "match": 0, "inplac": 0, "input": [0, 1], "callabl": 0, "written": 0, "same": 0, "exir": [0, 1, 8], "you": [0, 8, 16, 30], "so": 0, "find": [0, 1], "correct": 0, "treat": 0, "wildcard": 0, "from": [0, 1, 8, 16, 30], "import": [0, 1, 30], "subgraph_rewrit": 0, "replace_pattern": 0, "replaced_pattern": 0, "replace_pattern_with_filt": 0, "traced_modul": 0, "replacedpattern": 0, "dataclass": 0, "wa": 0, "found": [0, 1, 16], "anchor": 0, "larger": 0, "nodes_map": 0, "were": [0, 30], "ad": [0, 1], "have": [0, 1, 30], "normal": 0, "stack_trac": 0, "val": 0, "nn_module_stack": 0, "third": [0, 1], "most": [0, 1, 16], "basic": 0, "passbas": 0, "content": [0, 16], "addition": 0, "requir": [0, 1], "befor": [0, 1, 8, 16], "note": [0, 16], "also": [0, 1, 8], "overridden": 0, "directli": [0, 1], "instanc": 0, "replaceaddpass": 0, "__init__": [0, 1, 16], "replace_op": 0, "gm": [0, 1], "target": 0, "option": [0, 1], "rais": 0, "valueerror": 0, "No": 0, "replace_add_with_div": 0, "div": 0, "passmanag": 0, "multipl": [0, 1], "initi": 0, "set": 0, "flag": [0, 8], "collect": 0, "executorch": [0, 1, 29], "pass_manag": 0, "pm": 0, "replace_div_with_mul": 0, "run_checks_after_each_pass": 0, "true": 0, "suppress_check_failur": 0, "fals": 0, "graph_module_out": 0, "common": [0, 16], "check": [0, 8], "set_check": 0, "take": [0, 1], "check_div_target": 0, "should": [0, 1, 8], "add_check": 0, "There": [0, 1], "partit": 0, "howev": [0, 1, 8], "necessarili": 0, "produc": [0, 1], "compliant": 0, "care": 0, "them": [0, 8], "specif": [0, 1, 30], "subgraphmatch": 0, "attribut": 0, "placehold": [0, 1], "match_output": 0, "output": [0, 16, 30], "part": [0, 1, 8], "ignor": 0, "dure": [0, 1], "match_placehold": 0, "remove_overlapping_match": 0, "overlap": 0, "onli": [0, 1, 16, 30], "first": [0, 1], "ignore_liter": 0, "liter": 0, "equal": 0, "instead": 0, "matcher_util": 0, "largemodel": 0, "_weight": 0, "paramet": [0, 1, 16], "ones": [0, 1], "_bia": 0, "addmm": 0, "large_model_graph": 0, "captur": [0, 1], "large_input": 0, "to_edg": [0, 1], "patternmodel": 0, "_weight_1": 0, "5": [0, 1, 30], "_bias_1": 0, "pattern_graph": 0, "pattern_input": 0, "subgraph_match": 0, "match_result": 0, "internalmatch": 0, "field": 0, "default_factori": 0, "placeholder_nod": 0, "returning_nod": 0, "largest": 0, "support": [0, 1], "capabilitybasedpartition": 0, "operator_support": 0, "operatorsupportbas": 0, "object": 0, "determin": 0, "allows_single_node_partit": 0, "singl": 0, "form": 0, "non_compute_op": 0, "sequenc": 0, "str": [0, 1], "non": [0, 1], "comput": 0, "ex": 0, "view": 0, "_oper": 0, "getitem": 0, "allowed_single_node_partition_op": 0, "belong": 0, "done": [0, 1], "overrid": 0, "is_node_support": 0, "chain": 0, "operatorsuppportbas": 0, "ani": [0, 1], "any_chain": 0, "infra": 0, "addmuloperatorsupport": 0, "submodul": [0, 1], "capability_partition": 0, "op_support": 0, "partition_list": 0, "propose_partit": 0, "mai": [0, 1, 8], "fuse_partit": 0, "modifi": [0, 16], "toplevel": 0, "through": [0, 1, 8, 30], "call_modul": 0, "becaus": [0, 8], "provid": [0, 1, 8], "generate_pattern_op_partit": 0, "These": [0, 1, 8], "obtain": 0, "recommend": 0, "symbol": 0, "accur": 0, "edg": [0, 1], "dialect": [0, 1], "manual": 0, "craft": 0, "get": [0, 1, 29], "create_op_support": 0, "create_pattern_support": 0, "togeth": 0, "possibl": 0, "union": 0, "more": [0, 1, 16], "complic": 0, "user": [0, 1, 8, 30], "higher": 0, "linear": 0, "now": [0, 1], "decompos": [0, 1], "permut": 0, "get_source_partit": 0, "wanted_sourc": 0, "sourcepartit": 0, "leaf": 0, "dictionari": 0, "correspond": 0, "flatten": 0, "particular": 0, "module_typ": 0, "need": [0, 1, 8, 18], "input_nod": 0, "being": [0, 1], "outsid": 0, "output_nod": 0, "param": 0, "m": 0, "linear1": 0, "linear2": 0, "randn": [0, 1], "edge_graph": 0, "print": [0, 1, 16, 30], "arg0": 0, "_param_constant0": 0, "get_attr": [0, 1], "permute_default": 0, "permute_copi": 0, "_param_constant1": 0, "addmm_default": 0, "t_default": 0, "_param_constant0_1": 0, "permute_default_1": 0, "_param_constant1_1": 0, "addmm_default_1": 0, "t_default_1": 0, "relu_default": 0, "_param_constant2": 0, "permute_default_2": 0, "_param_constant3": 0, "addmm_default_2": 0, "t_default_2": 0, "module_partit": 0, "modulepartit": 0, "activ": 0, "entri": 1, "point": 1, "process": [1, 30], "pytorch": [1, 5, 8, 29, 30], "program": [1, 8], "leverag": 1, "effici": 1, "benefit": 1, "special": 1, "hardwar": 1, "still": 1, "experi": [1, 8], "close": 1, "At": 1, "high": 1, "level": 1, "defin": 1, "compon": 1, "repres": 1, "api": [1, 8], "aot": 1, "e": 1, "g": 1, "compil": 1, "optim": 1, "destroi": 1, "releas": [1, 8], "own": 1, "resourc": 1, "compos": 1, "expect": [1, 8], "blob": 1, "binari": [1, 8], "desir": 1, "profil": 1, "inform": [1, 16], "serial": 1, "file": [1, 16, 18, 30], "load": 1, "devic": [1, 8], "edge_program": 1, "exportedprogram": 1, "compile_spec": 1, "compilespec": 1, "preprocessresult": 1, "demo": 1, "here": [1, 16, 30], "loop": 1, "sin": 1, "instruct": 1, "string": 1, "later": 1, "pars": 1, "pass": 1, "custom": [1, 8], "init": 1, "respons": 1, "further": [1, 30], "unit": 1, "well": [1, 16], "handl": 1, "And": 1, "final": 1, "some": [1, 8], "its": 1, "lifespan": 1, "__et_nodiscard": 1, "virtual": 1, "delegatehandl": 1, "freeablebuff": 1, "arrayref": 1, "memoryalloc": 1, "memory_alloc": 1, "evalu": 1, "held": 1, "void": 1, "__et_unus": 1, "onc": 1, "readi": [1, 8], "thei": 1, "regist": 1, "simpli": 1, "test": [1, 8, 30], "backend_with_compiler_demo": 1, "backendwithcompilerdemo": 1, "via": 1, "register_backend": 1, "const": 1, "three": 1, "good": 1, "stage": [1, 8], "reus": 1, "export": [1, 8], "accord": 1, "partition": 1, "model": 1, "both": [1, 16], "streamlin": 1, "procecss": 1, "start": [1, 16, 29], "represent": [1, 8], "loweredbackendmodul": 1, "document": [1, 5, 16], "python": [1, 16, 29, 30], "refer": [1, 16], "backend_api": 1, "py": [1, 16, 30], "to_backend": 1, "backend_id": 1, "emit": 1, "flatbuff": 1, "put": 1, "back": 1, "parent": 1, "eventu": 1, "methodcompilespec": 1, "In": [1, 8, 16], "lowerablesubmodel": 1, "x": [1, 30], "to_be_low": 1, "example_input": 1, "to_be_lowered_exir_submodul": 1, "lowered_modul": 1, "format": 1, "save": 1, "local": [1, 30], "save_path": 1, "pte": 1, "open": 1, "wb": 1, "write": 1, "buffer": 1, "altern": 1, "executor": 1, "nonlowerablesubmodel": 1, "bia": 1, "lowerpart": 1, "compositemodel": 1, "non_lower": 1, "ret": 1, "composite_model": 1, "model_input": 1, "exec_prog": 1, "to_executorch": 1, "certain": 1, "overload": 1, "tpartition": 1, "tag": [1, 8], "meant": 1, "partition_tag": 1, "avail": [1, 5, 8], "insert": 1, "top": 1, "op_partitioner_demo": 1, "addmulpartitionerdemo": 1, "executorchbackendconfig": 1, "specproppass": 1, "store": 1, "real": 1, "warn": [1, 16], "pybind": 1, "partner": 1, "preview": 1, "pleas": 1, "size_test_all_op": 1, "executor_runn": 1, "cpp": 1, "mvp": 1, "executorch_modul": 1, "_load_for_executorch_from_buff": 1, "model_output": 1, "debug": 1, "handler": 1, "thrown": 1, "surfac": 1, "sourc": [1, 16, 29, 30], "below": [1, 30], "tan": 1, "problemat": 1, "tanmodul": 1, "tan_modul": 1, "edgeir_m": 1, "lowered_tan_modul": 1, "compositemodelwithtan": 1, "lowered_tan": 1, "output_from_submodul": 1, "composite_model_with_tan": 1, "buff": 1, "throw": 1, "tan_default": 1, "debug_handl": 1, "how": [1, 8, 16], "data": 1, "lift": 1, "static": 1, "weight": 1, "bias": 1, "suppli": 1, "access": 1, "get_param": 1, "_export": 1, "util": 1, "emb": 1, "d": 1, "state": 1, "descript": 1, "haven": 1, "t": 1, "yet": [1, 8], "4": [1, 16], "show": 1, "up": 1, "control": [1, 30], "won": 1, "hold": 1, "ye": 1, "two": 1, "differ": 1, "backend_1": 1, "backend_2": 1, "paritition": 1, "backend_1_paritition": 1, "backend_2_partition": 1, "Will": 1, "algorithm": 1, "exported_program_backend_1": 1, "exported_program": 1, "rest": 1, "backend_2_paritition": 1, "exported_program_backend_1_and_2": 1, "conret": 1, "qnnpack": 1, "xnnpack": 1, "box": 1, "easi": 1, "try": 1, "becuas": 1, "usual": 1, "order": 1, "better": 1, "go": [1, 30], "sai": 1, "backend_1_2_partition": 1, "insid": 1, "logic": 1, "regardless": 1, "backend2": 1, "none": 1, "delegation_spec_1": 1, "delegationspec": 1, "backend1": 1, "delegation_spec_2": 1, "edge_graph_modul": 1, "partiton": 1, "node_to_backend_1": 1, "select": 1, "delegation_tag": 1, "backend2_tag": 1, "partitioner_1": 1, "id": 1, "node_to_backend_2": 1, "partitioner_2": 1, "6": 1, "Is": 1, "tba": [2, 3, 4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28], "http": [5, 29], "org": [5, 29], "doc": 5, "2": [5, 16, 30], "1": [5, 16, 30], "html": [5, 29, 30], "redirect": 5, "3": [5, 30], "second": [5, 30], "platform": 8, "infrastructur": 8, "everywher": 8, "vr": 8, "wearabl": 8, "standard": [8, 16], "io": 8, "android": 8, "mobil": 8, "deploy": 8, "One": 8, "main": 8, "goal": 8, "enabl": 8, "wider": 8, "capabl": 8, "heavili": 8, "reli": 8, "technolog": 8, "torchdynamo": 8, "familiar": 8, "read": [8, 30], "about": 8, "dive": 8, "featur": 8, "describ": [8, 30], "classifi": 8, "statu": 8, "stabl": 8, "long": 8, "term": 8, "gener": [8, 29, 30], "major": 8, "limit": 8, "gap": 8, "compat": 8, "although": 8, "break": 8, "happen": 8, "notic": 8, "ahead": 8, "beta": 8, "base": 8, "feedback": 8, "improv": 8, "coverag": 8, "across": 8, "complet": 8, "commit": 8, "classif": 8, "prototyp": 8, "typic": 8, "distribut": 8, "pypi": 8, "conda": 8, "sometim": 8, "behind": 8, "earli": 8, "topic": [8, 30], "section": [8, 16], "help": 8, "what": [8, 30], "gentl": 8, "introduct": 8, "learn": [8, 30], "your": [8, 16, 30], "step": 8, "intermedi": 8, "interact": 8, "templat": [8, 29], "delet": 8, "titl": 11, "repositori": [16, 30], "restructuredtext": 16, "author": [16, 30], "direct": 16, "expand": 16, "contribut": 16, "myst": 16, "parser": 16, "similarli": 16, "page": 16, "ha": 16, "extens": 16, "syntax": 16, "extend": 16, "width": 16, "align": 16, "_static": 16, "img": 16, "png": 16, "s_demo_note_sourc": 16, "alt": 16, "bg": 16, "primari": 16, "150px": 16, "center": 16, "caption": 16, "my": 16, "emphas": 16, "line": 16, "lineno": 16, "between": 16, "end": [16, 30], "marker": 16, "literalinclud": 16, "sampl": 16, "person": 16, "ag": 16, "introduc": 16, "hello": 16, "am": 16, "year": 16, "old": 16, "alic": 16, "25": 16, "rst": 18, "template_tutori": [29, 30], "download": [29, 30], "tutorials_python": 29, "zip": 29, "jupyt": [29, 30], "notebook": [29, 30], "tutorials_jupyt": 29, "galleri": [29, 30], "sphinx": [29, 30], "full": 30, "firstnam": 30, "lastnam": 30, "item": 30, "prerequisit": 30, "v2": 30, "gpu": 30, "video": 30, "gallery_pattern": 30, "environ": 30, "variabl": 30, "respect": 30, "regular": 30, "express": 30, "neural_style_transfer_tutori": 30, "command": 30, "build": 30, "_build": 30, "beginner_sourc": 30, "directori": 30, "Then": 30, "verifi": 30, "correctli": 30, "why": 30, "link": 30, "relev": 30, "research": 30, "paper": 30, "walk": 30, "automat": 30, "rand": 30, "practic": 30, "knowledg": 30, "nlp": 30, "scratch": 30, "summar": 30, "concept": 30, "cover": 30, "highlight": 30, "takeawai": 30, "link1": 30, "link2": 30, "total": 30, "script": 30, "minut": 30, "000": 30, "ipynb": 30}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"custom": [0, 14, 17, 21], "compil": [0, 20], "pass": [0, 2], "partition": 0, "level": [0, 6], "1": [0, 1], "One": 0, "x": 0, "none": 0, "util": 0, "local": 0, "inform": 0, "2": [0, 1], "3": [0, 1], "manag": 0, "subgraph": 0, "matcher": 0, "capabl": 0, "base": 0, "combin": 0, "sourc": 0, "backend": [1, 19], "deleg": [1, 19, 27], "interfac": 1, "ahead": 1, "time": 1, "preprocess": 1, "runtim": [1, 18, 22, 23], "initi": 1, "execut": 1, "frontend": 1, "flow": 1, "lower": 1, "whole": 1, "modul": 1, "composit": 1, "partit": 1, "error": [1, 22], "messag": 1, "common": 1, "question": 1, "kernel": [2, 14, 15], "fusion": 2, "memori": [3, 21], "plan": 3, "export": [4, 5], "executorch": [4, 6, 7, 8, 10], "user": 5, "guid": 5, "high": [6, 12], "architectur": 6, "compon": 6, "set": 7, "up": 7, "welcom": 8, "document": 8, "get": 8, "start": 8, "tutori": [8, 29, 30], "exampl": 8, "how": 9, "work": 9, "overview": [10, 15, 23, 30], "exir": 11, "order": 12, "oper": 12, "opset": 13, "definit": 13, "aten": 14, "compliant": 14, "implement": [14, 19], "link": [14, 19], "librari": 15, "markdown": 16, "sphinx": 16, "tip": 16, "trick": 16, "admonit": 16, "imag": 16, "code": 16, "block": 16, "quantiz": 17, "api": 18, "build": 20, "cross": 20, "alloc": 21, "handl": 22, "platform": 24, "abstract": 24, "layer": 24, "bundledio": 25, "debug": 26, "integr": 27, "profil": 28, "templat": 30, "step": 30, "option": 30, "addit": 30, "exercis": 30, "conclus": 30}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 56}})